<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>AMD family 17 CPU p-state control</title></head>
<body><p align="center"><font face="Arial"><i>GriffinControl&mdash;making
the usage
of AMD
family 17, codename "griffin"&nbsp;mobile CPUs more </i></font><font face="Arial"><i>comfortable</i></font></p><p align="center"><font face="Arial"><small>(by the developer of world's 1st* Griffin undervolting tool) &nbsp; *at least world's 1st public known</small></font><font face="Arial"><small></small></font><font face="Arial"></font></p><br>News:<ul><li>01
November 2009: on 16 October 2009 I asked AMD to support me for the
development. If they do not the development is decelerated. It's not my
problem if they do not react...I have to concentrate on more profitable
things if I want to be/ remain self-employed. So I added support for
Pentium M (Core 2 &nbsp;Duo could be the next). And yes, it's already
working well with even <a href="http://en.wikipedia.org/wiki/Dynamic_frequency_scaling">dyn. freq. and voltage scaling</a> support. By the way: for AMD Griffins&nbsp;<a href="http://en.wikipedia.org/wiki/Dynamic_frequency_scaling">freq. and voltage scaling</a> works for 2 cores now but still not elaborate (does not consider "QL" CPUs, ..) so it's not released yet.</li><li>25 September 2009: finally! :&nbsp;own CPU load based <a href="http://en.wikipedia.org/wiki/Dynamic_frequency_scaling">dyn. freq. and voltage scaling</a> (freqs between 1/4 and 1/2 were set; freqs &gt; 1/2 max. freq <u>and</u> &lt; max freq are buggy, it seems&nbsp; to be a CPU erratum) along an undervolting curve seems to work <u>correctly</u> now (TODOs for that before release: further testing; quick and dirty implementation-&gt; reorganize code&nbsp;)</li><li>15
September 2009: added HTML help files files for service, configuration
file and usage (same that are linked here on the website) to the
downloadable zip file (finally)</li><li>07 September 2009:&nbsp;concerning the&nbsp;<a href="GriffinControlGUI.html"><b>Graphical User Interface</b></a></li><ul><li>now allows to set more CPU core frequencies (before this setting was limited due to misinterpretation of the AMD documentation)</li><li>fixed memory leak by adding missing XML access deinitialisation</li><li>now allows to show and edit all 8&nbsp;<a href="#glossary_performance_state">performance states</a></li><li>changed behaviour: changing the&nbsp;<a href="#glossary_performance_state">performance states</a> number in the core settings dialog window now immediately shows its values</li></ul><li>06
September 2009: when reading AMD doc for K10 CPUs today I realized that
my tool could probably work with these K10s (Phenom II, Athlon
II,&nbsp;...) because of similarities between Griffin and K10 and this
maybe beginning from early versions(!)<br>This would explain my
speculation that there is a plagiarism? product out there that came
shortly after the Phenom II introduction (this software is
closed&nbsp;source; could be using my sourcecode without naming me; and
uses the same CPU access libraries as me). But the author does not seem
to have the balls to show contact info on&nbsp;his website.<br>Then <a href="configuration_file.html#skip_cpu_type_check">skip_cpu_type_check</a>="true" should be specified in the config file. But try at your own risk and inform me if it works.</li><li>08 August 2009: concerning the&nbsp;<a href="GriffinControlService.html"><b>service</b></a><b></b></li><ul><li>removed crash at startup that happened to some people running the service on Win7 64 bit&nbsp;?<br>-&gt;e-mail me whether it works or not</li><li>removed bug preventing application of voltage for performance state (p-state) 2</li><li>added an option to change a p-state's&nbsp;<a href="configuration_file.html#FreqInMHz">frequency in MHz</a></li><li>service does crash no more when stopping it(?)&nbsp;<br>-&gt;e-mail me whether it works or not</li></ul><li>26 Jul 2009 added blinking voltage &amp; frequency cursor to the GUI for better orientation</li><li><font color="#ff0000">20th May 2009: removed bug causing the service to crash at startup (confirmed by and thanks to Mihai M.)</font></li><li>May 2009: CPU name is retrieved now for comparing with name in config file</li><li>May 2009: service can be paused and continued now</li></ul><font face="Arial"><a href="overcome_0.75V_limit.html">to
my investigations corncering how to overcome AMD family 17's 0.75 V
limit</a><br><br>table
of
contents<br></font><ol><li><a href="#undervolting_basics">undervolting basics</a><br></li><li><a href="#type_of_this_software">Type/ goal/</a><a href="index.html#purpose">purpose </a><a href="#type_of_this_software"> of this tool</a></li><li><a href="#screenshot">Screenshot(s)</a><br></li><li><a href="#possible_gains">possible gains<br></a><a href="index.html#default_and_undervolting_curves">Default
and
undervolting frequency-voltage curves<br></a><a href="index.html#measurements">Measurements (power savings,
temperatures)</a><a href="#default_and_undervolting_curves"><br></a></li><li><a href="#CPU_models">(supposed
to be) supported/ successfully tested CPU models</a></li><li><a href="#supported_OSes">supported OSes</a><br></li><li><a href="#software_types">Variants of this software</a></li><li><a href="#downloads">Downloads</a></li><li><a href="index.html#planned_features">Planned features</a></li><li><a href="#AMD_family17_knowledge">AMD Griffin (family 17) specific knowledge</a></li><li><a href="usage.html">usage</a></li><li><a href="history.html">history</a></li></ol><h1><a name="undervolting_basics"></a><font face="Arial">1.&nbsp;</font><font face="Arial">undervolting basics </font></h1><font face="Arial">Even if some people think so, <b>undervolting
does <u>not</u> affect</b> the CPU's <b>performance
much</b>.
</font><font face="Arial">It&nbsp;simply takes away
the voltage safety margins of the default voltages (<a href="index.html#default_and_undervolting_curves">see here</a>)
that the manufacturer (AMD) has&nbsp;specified to guarantee CPUs
operate stable with the variations that CPUs even of the same model and
revisions may have. But because of these variations the stability with
the same voltage at the same frequency differs and so different power
saving gains are possible.</font><font face="Arial"><br>Undervolting
affects the CPU's performance under the following conditions:<br></font><ul><li>if
&nbsp;an undervolting program (as GriffinControl&nbsp;currently
only does) adjusts the voltages after resume from stand-by (ACPI-state
"S3") and hibernation, it needs to get informed of these resume events
by the OS. So there is a <u>little</u> CPU performance
that gets "lost"; but most of the time the "Windows Task-Manager" shows
0 % CPU usage for the GriffinControlService</li><li>if an
undervolting program such as RMClock dynamically adjusts CPU core's
voltage and frequency based on the CPU load it consumes more of the CPU
time: this depends essentially on the frequency (e.g. how many times
per second) the current CPU load is queried/ retrieved/ polled (ca.
1-2% CPU time for RMClock)</li></ul><font face="Arial"></font><font face="Arial"></font><h2><font face="Arial"><a name="type_of_this_software"></a>2.
type/ goal/ purpose
of this tool</font></h2><ul><li><font face="Arial">primarily&nbsp;to save current (see
also:&nbsp;<a href="#planned_features">planned features</a>
)</font></li><li><font face="Arial">so
it's mainly an undervolting tool</font></li></ul><blockquote>by
undervolting:<br></blockquote><blockquote><ul><li>longer
battery life (for non-native English speakers: ="battery runtime"/
duration while usage from full to empty battery)</li><li>to
lower the temperature of the CPU&nbsp;</li><li>enlargen
meantime before failure because of too hot CPU</li><li>to
save (money for) current used by the CPU (okay, not a strong argument
:-P)</li><li>save current if used with power adapter and
its
wattage/ capacity is limited</li><li>less noisy
ventilator/ (fan)</li><li>avoid/ decrease thermal throttling &nbsp;(when under high load for a longer time the CPU changes to&nbsp;<a href="#glossary_performance_state">p-state</a> 1)</li></ul></blockquote><h1><font face="Arial"><a name="screenshot"></a>3.Screenshot(s)</font></h1>Installing the service:<blockquote><font face="Arial"><img alt="d" src="Screenshots/service/GriffinControlService--console_output_after_installing.png" height="379" width="668"><br><br></font></blockquote>The Graphical User Interface:<br><img alt="Griffin control GUI" src="Screenshots/GUI/GriffinControlGUI_07_Sep2009_release_2_open_core_settings_dialogs.png" height="596" width="730"><br><h1><a name="possible_gains"></a>4. Possible gains</h1><h2>4.1.
Default and
undervolting frequency-voltage curves</h2><font face="Arial">Here
you
can see what gains are possible (Turion Ultra ZM-82 CPU); <br>2200 MHz </font><font face="Arial">(maximal frequency) </font><font face="Arial">is&nbsp;<a href="#glossary_performance_state">performance state</a> number 0, </font><font face="Arial">1100 MHz (1/2 max. frequency) is&nbsp;<a href="#glossary_performance_state">performance state</a> number 1, </font><font face="Arial">550</font><font face="Arial"> </font><font face="Arial">MHz </font><font face="Arial">(1/4 max. frequency) </font><font face="Arial">is&nbsp;</font><font face="Arial"><a href="index.html#glossary_performance_state">performance state</a></font><font face="Arial"> number 2</font><font face="Arial">): <br>top
curve: default voltages, also overvolting protection curve<br>bottom
curve: undervolted<br><a name="default_and_undervolting_curves"></a><img alt="default voltage and undervolting curve" src="default_voltage_and_undervolting_curve.PNG" height="537" width="575"><br>Note:
as you can see the formula is not correct for low CPU core frequencies
(even with e.g. 1 MHz one needs an operating voltage). But the values
with this formula/ function&nbsp;works for the default
voltage-frequency pairs (550 MHz at 0.8 V, 1100 MHz at 0.95 V, 2200 MHz
at 1.1 V) and the undervolting curve is derived from this formula.<br></font><h2><font face="Arial"><a name="measurements"></a>4.2.
Measurements</font></h2><font face="Arial">Test
conditions for the following
test: <br></font><ul><li><font face="Arial">HP tx2550eg laptop</font></li><li><font face="Arial">rime95:
in-place </font><font face="Arial">large </font><font face="Arial">FFTs for both cores of a ZM-82 (max. 2200 MHz)
CPU: both cores have 100% CPU load.</font></li><li><font face="Arial">wattage measuring device </font><font face="Arial">("EKM 265") </font><font face="Arial">between
power adaptor and power outlet</font></li><li><font face="Arial">wireless (WLAN and bluetooth) on</font></li><li><font face="Arial">bright display</font></li><li><font face="Arial">large battery (8 or 9 cell) inside (<b>not</b> being charged at the test time)</font></li><li><font face="Arial">HDD surely spinning, </font><font face="Arial">optical drive not </font></li><li><font face="Arial">no other devices except a mouse attached<br></font></li></ul><table border="1" cellpadding="2" cellspacing="2" width="100%"><tbody><tr><td>frequency for
all CPU cores in MHz</td><td>Voltage</td><td>wattage
after ca. 12 min</td><td>both CPU cores' temperature after
ca. 12 min</td></tr><tr><td>1100</td><td>0.8
V (undervolted)</td><td>varying between 39.3 W and 41.5 W </td><td>60
&deg;C (139 &deg; F)</td></tr><tr><td>1100</td><td>0.95
V (default voltage)</td><td>varying between 44.1 W and 46.1
W </td><td>66 &deg; C (varying between 149 &deg; F
and 151 &deg; F)</td></tr></tbody></table><font face="Arial"><br></font><h2><a name="CPU_models"></a><font face="Arial">5.
(supposed to be)
supported/
successfully tested CPU models</font></h2><table border="1" cellpadding="2" cellspacing="2" width="100%"><tbody><tr><td>CPU
model</td><td>tester/ reported by</td></tr><tr><td>Turion
Ultra ZM-82 (max. 2200 MHz)</td><td>me</td></tr><tr><td>Turion
Ultra ZM-86 (max. 2400 MHz)</td><td>member of
tabletpcreview.com</td></tr><tr><td>Turion
RM-70 (max. 2000? MHz)</td><td>member&nbsp;of
tabletpcreview.com</td></tr><tr><td>Athlon
QL-60</td><td>member&nbsp;of tabletpcreview.com</td></tr></tbody></table><h1><a name="supported_OSes"></a>6.&nbsp;supported OSes</h1><ul><li>Windows XP?</li><li>Windows
Vista</li><li>Windows 7</li></ul><h2><font face="Arial"><a name="software_types"></a>7.
Variants of this software</font></h2><blockquote>This
undervolting software exists in 2 versions:<br><ul><li>The
<a href="GriffinControlGUI.html">graphical application</a> to test for low voltages&ndash;has to be tested a bit</li><li><a href="GriffinControlService.html">the Windows service</a>&nbsp;to
use the voltages (that you can examine via the&nbsp;<a href="GriffinControlGUI.png">graphical application</a>)&ndash;by running the undervolting applications as a service you do not need to log on in order to undervolt your
CPU</li></ul></blockquote><h2><a name="downloads"></a><font face="Arial">8.
Downloads</font></h2><ul><li>Note
why
I want to make some money: <br>Primarily I did the development
for myself, but I also invested a lot of time</li><ul><li>customizing
to the needs of users,&nbsp;</li><li>making the
handling of the
software more user friendly and&nbsp;</li><li>writing
documentation/ instruction
(HTML) files.</li></ul></ul><blockquote>&nbsp;This
time I could have used for earning money: 10 Euro/h
job are realistic because I am
in the last semester of my studies of applied computer science,
so&nbsp;I have high skills&ndash;no, I do not mean the old sourcecode
;-), my new from 2009 one has much higher quality and thus the
binary(.exe) files also have.</blockquote>
<table border="0" cellpadding="2" cellspacing="2" width="100%"><tbody><tr><td></td><td align="center"><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input name="cmd" value="_s-xclick" type="hidden"><input name="hosted_button_id" value="3079860" type="hidden"><input src="https://www.paypal.com/en_US/i/btn/btn_donateCC_LG.gif" name="submit" alt="" border="0" type="image"><img alt="" src="https://www.paypal.com/de_DE/i/scr/pixel.gif" border="0" height="1" width="1"></form></td><td></td></tr></tbody></table><blockquote><font face="Arial">Feel
free to send me some money :-), especially if you appreciate/ want to
honor my (months of) work.<br></font><font face="Arial">If
you have wishes submit a
comment to <img alt="amd --AT-- goexchange DOT de" src="e-mail-address.gif"><br>
then. Wishes with high donations have priority over usual wishes.
The more people want the same respectively if I regard
it as senseful then I implement a feature/ make changes.&nbsp;If you want to donate, donate at least ~50 US Cent
&ndash; 1 US Dollar, else the PayPal fees could take the amount
completely away. On the other hand: do not donate so much you could
regret.</font>
</blockquote><ul><li>this
software is free of charge for private use</li><li>if it
should be used on commercial used&nbsp;devices,&nbsp;</li><ul><li>I
want to charge 4 USD (the program has not many features, but below this amount writing invoices is not worth
the effort for me) for a single licence for a single device this
software is used for</li><li>contact me (for payment): <font face="Arial"><img alt="amd --AT-- goexchange DOT de" src="e-mail-address.gif" height="15" width="120"></font></li><li>you
are allowed to test the latest version free of charge for 3 weeks
beginning from the first day of usage<br></li></ul></ul>
<ul><li>changes
compared to version from 31st december 2008 ougth to be:<ul><li>correct
overvolting protection</li><li>fixed startup error on some
machines(?)</li></ul></li><li><font color="#ff0000">Use this software at your own risk! I can only test for my CPU.</font></li><li><h3>32 Bit</h3></li><ul><li>latest all-in-one package (executable herein may be older than the executable-only file)</li><ul><li></li></ul><li>latest executable (can be more up-to-date than the&nbsp;all-in-one  package:&nbsp;I
seperated the "supporting" files and the exe because then the
executable is easier to update;
<font color="#ff0000">unpack/extract/unzip the&nbsp;supporting files and </font><font color="#ff0000">put them together with </font><font color="#ff0000">the .exe
file into
the same directory)</font></li><ul><li><a href="files--config,DLL,sys,help.zip">supporting files
(needed additionally
to the
executable)</a> : ca. 535 KB<br>the zip file contains:</li><ul><li>DLL and driver file for&nbsp;CPU access  (32 and 64 bit)</li><li>configuration file</li><li>HTML help files for service, configuration file and usage</li></ul><li><a href="GriffinControlService_32bit.exe">Windows service and service
installer as one and the same executable (32 bit)</a> : ca. 1.5 MB; build date:&nbsp;08 August 2009;&nbsp;<a href="GriffinControlService.html">how to install</a>&nbsp;</li><li><a href="GriffinControlDialog32bit.exe">The Graphical User Interface to test for low voltages easily</a> (ca. 2.5 MB), build date:&nbsp;07 September 2009 GMT+1; for Windows Vista/ 6.1 and its successor(s)<br>notes:&nbsp;</li><ul><li>just a beta version--not tested very much; use at your own risk</li><li>Please send me your possible <b>stable</b> frequencies incl. your exact CPU model e.g. via e-mail. I wasn't able to run all available frequencies stable.</li></ul></ul></ul><li><h3>64 Bit</h3></li><ul><li>latest all-in-one package&nbsp;(executable herein may be older than the executable-only file)</li><ul><li></li></ul><li>latest executable (can be more up-to-date than the&nbsp;all-in-one  package:&nbsp;I
seperated the "supporting" files and the exe because then the
executable is easier to update;&nbsp;<font color="#ff0000">unpack/extract/unzip the&nbsp;supporting files and </font><font color="#ff0000">put them together with </font><font color="#ff0000">the .exe</font><font color="#ff0000">
into
the same directory)</font></li><ul><li><a href="files--config,DLL,sys,help.zip">supporting files
(needed additionally
to the
executable)</a> : ca. 535 KB<br>the zip file contains:</li><ul><li>DLL and driver file for&nbsp;CPU access  (32 and 64 bit)</li><li>configuration file</li><li>HTML help files for service, configuration file and usage</li></ul><li><a href="GriffinControlService_64bit.exe">Windows service and service
installer as one and the same executable (64 bit)</a> : ca. 2.2 MB; build date:&nbsp;08 August 2009; <a href="GriffinControlService.html">how to install</a>&nbsp;</li><li><a href="GriffinControlGUI64bit.exe">The Graphical User Interface to test for low voltages easily</a> (ca. 3.8 MB), build date:&nbsp;07 September 2009 GMT+1; for Windows Vista/ 6.1 and its successor(s)<br>notes:&nbsp;</li><ul><li>just a beta version--not tested very much; use at your own risk</li><li>I can't test this 64 bit version. Please e-mail me whether it works or not.</li><li>Please send me your possible <b>stable</b> frequencies incl. your exact CPU model e.g. via e-mail. I wasn't able to run all available frequencies stable.</li></ul></ul></ul></ul><h2><a name="planned_features"></a>9.&nbsp;Planned
features</h2><ul><li>make the GUI also available for&nbsp;Windows &lt; version 6 (Win XP, maybe also Window 2000 or even before): nearly finished</li><li>control the service via the (optional) GUI:&nbsp;a beginning has been made</li><li>possibilty to send the GUI to systray:&nbsp;a beginning has been made</li><li><b>own dynamic voltage &amp;
frequency scaling</b>
with CPU core
frequencies also between the default p-states according
to CPU load (as the OS does, but finer; should save even more
current than just undervolting for p-states 0,1 &amp; 2)</li><ul><li>current status (01.Nov.2009), TODOs and so&nbsp;on:</li><ul><li>already
works for all cores, but QL CPUs would surely not be treated correctly</li><li>setting
intermediate steps (for ZM-82 also between 1050, 1000, ... instead of
just 3 frequencies 550,1100,2200) needs to be implemented again<br></li></ul></ul></ul><h2><a name="AMD_family17_knowledge"></a>10. AMD Griffin (family 17) specific knowledge</h2><ul><li>sometimes I was able to change the voltage and <b>frequency &gt;= 1/2 of max. frequency</b> when the CPU was under high load. But when the CPU was under low load afterwards it freezed.&nbsp;</li><li><b>overclocking</b> by setting frequency in the CPU registers via MSR (multiplier and divisor) <b>is not possible</b> in my opinion. Even if you increase the Frequency ID to a FID &gt;<i> default FID of the p-states</i>, "AMD power monitor" shows a higher frequency in MHz but this is not the real frequency (I checked this via benchmarks).</li><li>By showing the values of the "<u>C</u>urrent <u>O</u>perating <u>F</u>requency and <u>V</u>oltage <u>ID</u> status" register I observed that the CPU switched to performance state 7 (in my settings: 1100 MHz at <b>1.2 V</b>) in between (although this p-state does <u>not</u> have the "valid" bit set!) &nbsp;under the follwing conditions:</li><ul><li>when not under high load</li><li>core frequency &gt; 1/2 of max. freq. (in Windows: &nbsp;CPU load in percent &gt; 50 %) :<br><br>AMD documentation: "Lower performance P-states (higher numbered P-states) must have a COF that is less than or equal to higher<br>performance P-states (lower numbered P-states). Lower performance P-states must also have a VID that is<br>higher than or equal to (voltage that is lower than or equal to) higher performance P-states."<br></li></ul><ul><li>So my guess: The switch to p-state 7 (1100 MHz at 1.2 V) causes the freeze?</li></ul><li><b>thermal protection</b>: the CPU switches to performance state 1 (often 1/2 of max. CPU frequency) when the temp is too high</li><li>the
p-state 7 is changeable without freezing when setting max CPU % to &lt;=50,
but when setting the&nbsp;max CPU % to &gt; 50 afterwards the computer
freezes when freq is higher 50% of max. freq.</li><li>after Windows CPU Power settings: min. CPU%:0, max. CPU%:0:</li><ul><li>changing p-state 0-&gt;freeze</li><li>changing p-state 1 to 1300 MHz @ 0.95V:-&gt;freeze, keyboard light blinks</li></ul><li>when writing via <b>COFVID</b> control register:&nbsp;</li><ul><li>select another p-state number than before. else nothing changes</li></ul><ul><li>600 MHz: worked</li><li>900 MHz: worked</li><li>800 MHz worked</li><li>1300 MHz: from 900MHz? at p-state 1 to P0: freezed &amp; keyboard light blinked</li><li>1100 MHz at P1 to 1050 MHz at P2: worked</li><li>1050 MHz at P2 to P1: 1200 MHz (FID 4, DID 0) at 0.95 V: freezed, black screen, only mouse cursor is visible</li><li>1100 MHz at P1 to P0: 1800 MHz (FID 10, DID 0) at 1.05 V:&nbsp;freezed, black screen, only mouse cursor is visible</li><li>2200 MHz at P0 to P1: 2100 MHz (FID 13, DID 0) at 1.0875 V:</li></ul><li>setting
performance state 1 to 1200 MHz (DID 1, FID: 4), VID=47 (0.9625 Volt):
freezed, black screen, only mouse cursor is visible</li><li>p-state&nbsp;0
100% CPU&nbsp; load&nbsp;on core 0: 1600 MHz (DID: 0) , VID: 43 (1,0125
V):&nbsp;black screen, only mouse cursor is visible</li></ul><br>If Windows does not start because the GriffinControl is started
automatically (e.g. Autostart or as service) you may start Windows in
maintance mode and e.g. set the service type to "manual start".<h2>11. Glossary</h2><ul><li>CPU undervolting: <br>running a CPU with a voltage lower than the default voltage</li><li><a name="glossary_performance_state"></a>performance state (p-state): &nbsp;<br><ul><li>pair
of CPU core frequency and CPU core voltage. Modern CPUs support
several of these states. Software such as the OS or CPU driver should
select the performance according to the current CPU load. So
a performance state with lower voltage and thus lower power consumption
is selected when the CPU usage is low.</li><li>Windows only uses p-states 0,1,2 and 7 (if freq higher than 1/2 of max. freq)</li></ul></li></ul><h2>11. User
voices </h2>(partially just for fun :-D )&ndash;positive and
negative<br><ul><li>"better
than nothing" (translated from an Italian WWW forum)&ndash;refers to an
early version of this software. Yeah, this could&nbsp;(have) be(en) my
&nbsp;advertising slogan :-P</li><li>report of saving
of 12 degrees (F? C? ; from notebookreview.com forum)</li></ul><br><font face="Arial">...and
the development </font><font face="Arial">(hopefully)
</font><font face="Arial">goes on<br><br><a href="imprint.html">Imprint</a></font></body></html>